{{ template "header" . }}
<div class="container-fluid">
	<!-- Page Heading -->
	<div class="d-sm-flex align-items-center justify-content-between mb-4">
		<h1 class="h3 mb-0 text-gray-800 mx-auto">Add User Priviledges</h1>
      
	</div>
        <div class="w-50 mx-auto">
     <form class="user" id="myform" method="post" action="/v1/users/addPriviledge">
        <div id="failureAlert" class="alert alert-danger mt-3" style="display: none;"></div>
        <div id="successAlert" class="alert alert-success mt-3" style="display: none;">
 		 </div>
            <div class="form-group">
                <input type="text" class="form-control " name="accountNumber"
                    id="exampleInputEmail" aria-describedby="emailHelp"
                    placeholder="Enter Account Number..." required>
                    <input type="text" class="form-control form-control-user d-none" name="id" value="{{ .Id }}"
                id="exampleInputEmail" aria-describedby="emailHelp"
                placeholder="Enter Account Number..." required>
            </div>
         
           <div class="mb-3">
						<label for="priviledge" class="form-label"></label>
						
						<select class="form-select " aria-label="Default select example" id="priviledge"
							name="priviledge"
							required>
							<option disabled  selected>Priviledges</option>
                            {{ range .Permissions }}
                                <option value="{{ .Permission }}">{{ .Permission }} </option>
                            {{ end }}
							
					
							
						</select>
					</div>

    
            <button type="button" onclick="submitForm()" class="btn btn-custom btn-user btn-block">Submit</button>           

        </form> 
        </div>
 
<script>
    function submitForm() {
        var formdata = new FormData(document.getElementById("myform"));
        var storedValue = sessionStorage.getItem('token');
        var requestOptions = {
            method: 'POST',
            headers: {
                'X-Auth-Token': storedValue,
            },
            body: formdata,
        };

        fetch("/v1/users/addPriviledge", requestOptions)
            .then(response => response.json()) // Parse the response as JSON
            .then(result => {
                console.log(result);
                if (result.responseCode === "00") {
                     document.getElementById("myform").reset();
                    // Update the success message with the message from the API
                    document.getElementById("successAlert").innerText = result.message;
                    // Show the success alert
                    document.getElementById("successAlert").style.display = "block";
                    // Hide the alert after 7 seconds
                    setTimeout(function () {
                        document.getElementById("successAlert").style.display = "none";
                    }, 7000);
                   
                } else if (result.responseCode === "06") {
                     document.getElementById("failureAlert").innerText = result.message;
                    // Show the failure alert
                    document.getElementById("failureAlert").style.display = "block";
                    // Hide the alert after 7 seconds
                    setTimeout(function () {
                        document.getElementById("failureAlert").style.display = "none";
                    }, 7000);
                }else{
                    window.location.href = "/v1/loginpage";
                }
            })
            .catch(error => console.log('error', error));
    }
</script>
{{ template "footer" . }}
